(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{125:function(e,a,o){"use strict";o.r(a),o.d(a,"frontMatter",(function(){return s})),o.d(a,"metadata",(function(){return n})),o.d(a,"toc",(function(){return d})),o.d(a,"default",(function(){return p}));var t=o(3),r=o(7),i=(o(0),o(144)),s={id:"conhecer",title:"Conhe\xe7a os servi\xe7os",sidebar_label:"Conhe\xe7a os servi\xe7os"},n={unversionedId:"publico-alvo/ti/conhecer",id:"publico-alvo/ti/conhecer",isDocsHomePage:!1,title:"Conhe\xe7a os servi\xe7os",description:"A conex\xe3o com a RNDS ocorre por meio de requisi\xe7\xf5es https em conformidade com o padr\xe3o FHIR. As requisi\xe7\xf5es devem partir da infraestrutura empregada pelo estabelecimento de sa\xfade e atingir os web services da RNDS.",source:"@site/docs/publico-alvo/ti/conhecer.md",slug:"/publico-alvo/ti/conhecer",permalink:"/rnds/docs/publico-alvo/ti/conhecer",version:"current",lastUpdatedAt:1619377014,formattedLastUpdatedAt:"4/25/2021",sidebar_label:"Conhe\xe7a os servi\xe7os",sidebar:"someSidebar",previous:{title:"Integrador",permalink:"/rnds/docs/publico-alvo/ti/ti"},next:{title:"Homologar",permalink:"/rnds/docs/publico-alvo/ti/homologar"}},d=[{value:"Cen\xe1rio de pr\xe1tica",id:"cen\xe1rio-de-pr\xe1tica",children:[]},{value:"Metas",id:"metas",children:[]},{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos",children:[]},{value:"Seguran\xe7a (<em>headers</em>)",id:"seguran\xe7a-headers",children:[]},{value:"Passos",id:"passos",children:[]},{value:"Importar <em>collection</em>",id:"importar-collection",children:[]},{value:"Fornecer o certificado digital para uso",id:"fornecer-o-certificado-digital-para-uso",children:[]},{value:"Configurar vari\xe1veis",id:"configurar-vari\xe1veis",children:[]},{value:"Experimentar requisi\xe7\xf5es",id:"experimentar-requisi\xe7\xf5es",children:[]},{value:"Como criar c\xf3digo correspondente \xe0s requisi\xe7\xf5es?",id:"como-criar-c\xf3digo-correspondente-\xe0s-requisi\xe7\xf5es",children:[]},{value:"Parab\xe9ns!",id:"parab\xe9ns",children:[]}],c={toc:d};function p(e){var a=e.components,s=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(t.a)({},c,s,{components:a,mdxType:"MDXLayout"}),Object(i.b)("p",null,"A conex\xe3o com a RNDS ocorre por meio de requisi\xe7\xf5es ",Object(i.b)("em",{parentName:"p"},"https")," em conformidade com o padr\xe3o FHIR. As requisi\xe7\xf5es devem partir da infraestrutura empregada pelo estabelecimento de sa\xfade e atingir os ",Object(i.b)("em",{parentName:"p"},"web services")," da RNDS."),Object(i.b)("p",null,"As requisi\xe7\xf5es est\xe3o devidamente ",Object(i.b)("a",{parentName:"p",href:"https://documenter.getpostman.com/view/215332/TVewY47S"},"documentadas")," e dispon\xedveis nos ",Object(i.b)("em",{parentName:"p"},"web services")," dos\n",Object(i.b)("a",{parentName:"p",href:"../../rnds/ambientes"},"ambientes")," oferecidos pela RNDS."),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"O foco aqui \xe9 esclarecer como submeter tais requisi\xe7\xf5es. Mesmo que o integrador j\xe1 possua experi\xeancia com requisi\xe7\xf5es ",Object(i.b)("em",{parentName:"p"},"https"),", \xe9 sugerida a leitura deste texto com o prop\xf3sito de ambienta\xe7\xe3o com os servi\xe7os oferecidos pela RNDS.")),Object(i.b)("h3",{id:"cen\xe1rio-de-pr\xe1tica"},"Cen\xe1rio de pr\xe1tica"),Object(i.b)("p",null,"A submiss\xe3o de requisi\xe7\xf5es \xe9 comentada com ilustra\xe7\xf5es que empregam a ferramenta ",Object(i.b)("a",{parentName:"p",href:"https://www.postman.com/downloads/"},"Postman")," (usada por desenvolvedores para intera\xe7\xe3o com ",Object(i.b)("em",{parentName:"p"},"web services"),"). Existem muitas outras op\xe7\xf5es e pode-se empregar qualquer uma delas."),Object(i.b)("p",null,"Os exemplos oferecidos s\xe3o compat\xedveis com as expectativas configuradas nos servidores FHIR da RNDS. Ou seja, as requisi\xe7\xf5es ilustram as respostas obtidas dos ambientes oferecidos pela RNDS. De fato, foram experimentadas no ambiente de homologa\xe7\xe3o."),Object(i.b)("div",{className:"admonition admonition-danger alert alert--danger"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"CUIDADO")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"O ambiente de produ\xe7\xe3o ",Object(i.b)("strong",{parentName:"p"},"n\xe3o deve")," ser empregado com a finalidade de experimentar a integra\xe7\xe3o com os ",Object(i.b)("em",{parentName:"p"},"web services")," da RNDS."))),Object(i.b)("p",null,"Embora desej\xe1vel o acesso ao ambiente de homologa\xe7\xe3o para validar o que est\xe1 sendo produzido, este acesso pode n\xe3o estar dispon\xedvel, o que n\xe3o impede a pr\xe1tica."),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"RECOMENDA\xc7\xc3O")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Empregar um servidor FHIR publicamente dispon\xedvel para experimenta\xe7\xe3o."))),Object(i.b)("h3",{id:"metas"},"Metas"),Object(i.b)("p",null,"Ao final, espera-se que voc\xea saiba:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"As requisi\xe7\xf5es dispon\xedveis."),Object(i.b)("li",{parentName:"ul"},"Os ",Object(i.b)("em",{parentName:"li"},"headers")," necess\xe1rios e como montar os valores correspondentes."),Object(i.b)("li",{parentName:"ul"},"A estrutura do ",Object(i.b)("a",{parentName:"li",href:"../../glossario#payload"},"payload")," para cada requisi\xe7\xe3o."),Object(i.b)("li",{parentName:"ul"},"Submeter as requisi\xe7\xf5es por meio da ferramenta Postman."),Object(i.b)("li",{parentName:"ul"},"Interpretar as respostas."),Object(i.b)("li",{parentName:"ul"},"Experimentar valores diferentes para o ",Object(i.b)("em",{parentName:"li"},"payload"),", ",Object(i.b)("em",{parentName:"li"},"headers")," e par\xe2metros (URL)."),Object(i.b)("li",{parentName:"ul"},"O fluxo t\xedpico da intera\xe7\xe3o com a RNDS usando HTTPS."),Object(i.b)("li",{parentName:"ul"},"Empregar o certificado digital para obter token de acesso.")),Object(i.b)("p",null,"Caso siga, compreenda e tenha praticado cada um dos itens abaixo, ter\xe1 adquirido parte relevante da habilidade necess\xe1ria para construir o ",Object(i.b)("a",{parentName:"p",href:"../../conector"},"conector"),"."),Object(i.b)("h3",{id:"pr\xe9-requisitos"},"Pr\xe9-requisitos"),Object(i.b)("p",null,"Conforme ilustrado, a intera\xe7\xe3o com a RNDS depende de v\xe1rias informa\xe7\xf5es e um arquivo (certificado digital) (destacados em verde). O arquivo adicional \xe9 a configura\xe7\xe3o do Postman (destacado em amarelo), ou seja, uma demanda espec\xedfica desta ferramenta, ao contr\xe1rio das demais."),Object(i.b)("p",null,Object(i.b)("img",{alt:"img",src:o(303).default})),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Informa\xe7\xf5es necess\xe1rias:"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"../gestor/identificador"},"Identificador do solicitante")," fornecido pela RNDS quando a ",Object(i.b)("a",{parentName:"li",href:"../gestor/portal"},"solicita\xe7\xe3o de acesso")," \xe9 aprovada. Esta aprova\xe7\xe3o, al\xe9m de definir o identificador do solicitante, tamb\xe9m autoriza o acesso ao ",Object(i.b)("a",{parentName:"li",href:"../../rnds/ambientes"},"ambiente de homologa\xe7\xe3o"),"."),Object(i.b)("li",{parentName:"ul"},"CNES. O CNES do laborat\xf3rio."),Object(i.b)("li",{parentName:"ul"},"CNS de um profissional de sa\xfade lotado no estabelecimento de sa\xfade cujo CNES \xe9 fornecido acima. O CNS indica em nome do quem as requisi\xe7\xf5es ao ambiente de homologa\xe7\xe3o ser\xe3o feitas."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Arquivos necess\xe1rios:"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("a",{parentName:"p",href:"../gestor/certificado"},"Certificado digital"),". O arquivo correspondente deve estar dispon\xedvel, \xe9 um arquivo com a extens\xe3o ",Object(i.b)("strong",{parentName:"p"},".pfx"),", aqui ser\xe1 referenciado por ",Object(i.b)("strong",{parentName:"p"},"certificado.pfx"),". Tamb\xe9m ser\xe1 necess\xe1ria a senha para acesso ao conte\xfado do certificado.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Baixe o arquivo JSON de (",Object(i.b)("a",{parentName:"p",href:"https://raw.githubusercontent.com/kyriosdata/rnds/master/tools/postman/rnds-postman-collection.json"},"configura\xe7\xe3o"),") do Postman, contendo exemplos de requisi\xe7\xf5es prontas. Al\xe9m das requisi\xe7\xf5es este arquivo tamb\xe9m cont\xe9m a documenta\xe7\xe3o de cada uma delas. A ",Object(i.b)("a",{parentName:"p",href:"https://documenter.getpostman.com/view/215332/TVewY47S"},"documenta\xe7\xe3o")," das requisi\xe7\xf5es tamb\xe9m encontra-se amplamente dispon\xedvel."))))),Object(i.b)("h3",{id:"seguran\xe7a-headers"},"Seguran\xe7a (",Object(i.b)("em",{parentName:"h3"},"headers"),")"),Object(i.b)("p",null,"Toda requisi\xe7\xe3o ao endere\xe7o ",Object(i.b)("em",{parentName:"p"},"EHR")," (veja ",Object(i.b)("a",{parentName:"p",href:"../../rnds/ambientes"},"ambientes"),"), faz uso de dois ",Object(i.b)("em",{parentName:"p"},"headers")," obrigat\xf3rios, aqui definidos como ",Object(i.b)("em",{parentName:"p"},"headers")," de seguran\xe7a:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"X-Authorization-Server"),": este \xe9 ",Object(i.b)("em",{parentName:"li"},"header")," por meio do qual o valor do ",Object(i.b)("em",{parentName:"li"},"token")," de acesso \xe9 fornecido. O valor deste ",Object(i.b)("em",{parentName:"li"},"header")," \xe9 definido pela concatena\xe7\xe3o de ",Object(i.b)("strong",{parentName:"li"},"Bearer ")," com o valor do ",Object(i.b)("em",{parentName:"li"},"token"),". Em consequ\xeancia, para o ",Object(i.b)("em",{parentName:"li"},"token"),' de valor "token", o valor do ',Object(i.b)("em",{parentName:"li"},"header")," seria ",Object(i.b)("inlineCode",{parentName:"li"},"Bearer token"),". Conv\xe9m ressaltar que o ",Object(i.b)("em",{parentName:"li"},"token"),' de acesso \xe9 uma sequ\xeancia de mais de 2000 caracteres e, portanto, bem mais extensa que o simples valor "token".'),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Authorization"),": neste ",Object(i.b)("em",{parentName:"li"},"header")," \xe9 identificado o profissional de sa\xfade, lotado no estabelecimento de sa\xfade em quest\xe3o, em nome do qual a requisi\xe7\xe3o \xe9 feita. O valor fornecido deve ser o CNS deste profissional.")),Object(i.b)("h3",{id:"passos"},"Passos"),Object(i.b)("p",null,"De posse das informa\xe7\xf5es e dos arquivos, veja se\xe7\xe3o anterior, pode-se configurar o Postman: (a) importar ",Object(i.b)("em",{parentName:"p"},"collection"),"; (b) configurar certificado digital e (c) configurar vari\xe1veis."),Object(i.b)("h3",{id:"importar-collection"},"Importar ",Object(i.b)("em",{parentName:"h3"},"collection")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Veja o v\xeddeo acerca de como importar ",Object(i.b)("a",{parentName:"p",href:"https://drive.google.com/file/d/13hbA4uZlX_90wFt0ktCvkX2jBbhFkoDC/view"},"aqui"))),Object(i.b)("p",null,"Ao abrir o Postman voc\xea ver\xe1 uma tela similar \xe0quela abaixo, exceto que n\xe3o ter\xe1 o destaque para o bot\xe3o ",Object(i.b)("inlineCode",{parentName:"p"},"Import"),', empregado para "importar" o arquivo baixado anteriormente:'),Object(i.b)("p",null,Object(i.b)("img",{alt:"postman-abertura",src:o(304).default})),Object(i.b)("p",null,'Ap\xf3s importado, o resultado \xe9 similar \xe0quele abaixo. A vers\xe3o pode ser diferente, por exemplo. Observe que est\xe3o dispon\xedveis 11 requisi\xe7\xf5es, agrupadas naquelas de "Seguran\xe7a" e "Sa\xfade".'),Object(i.b)("p",null,Object(i.b)("img",{alt:"image",src:o(305).default})),Object(i.b)("p",null,"Neste ponto pode-se selecionar uma das requisi\xe7\xf5es e, no canto superior direito, bot\xe3o ",Object(i.b)("inlineCode",{parentName:"p"},"Send")," submeter aquela selecionada. Contudo, qualquer uma delas deve falhar, afinal,\nn\xe3o indicamos o certificado a ser empregado nem outras configura\xe7\xf5es necess\xe1rias."),Object(i.b)("h3",{id:"fornecer-o-certificado-digital-para-uso"},"Fornecer o certificado digital para uso"),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Veja o v\xeddeo acerca de como configurar o Postman com o certificado digital ",Object(i.b)("a",{parentName:"p",href:"https://drive.google.com/file/d/1V1mSYStqnEHNg0iznWhAnNBlX3jETe3o/view"},"aqui"))),Object(i.b)("p",null,"O Postman precisa ser configurado para usar o certificado digital do estabelecimento de sa\xfade em quest\xe3o, quando uma requisi\xe7\xe3o for direcionada ao endere\xe7o empregado para autentica\xe7\xe3o do ambiente de homologa\xe7\xe3o."),Object(i.b)("p",null,'Esta configura\xe7\xe3o \xe9 exigida para a correta execu\xe7\xe3o do servi\xe7o denominado "Obter token de acesso". E o resultado desta requisi\xe7\xe3o \xe9 necess\xe1rio para a execu\xe7\xe3o de todos os demais servi\xe7os. Em tempo, este \xe9 o \xfanico servi\xe7o que usa diretamente o certificado digital.'),Object(i.b)("p",null,'O servi\xe7o "Obter token de acesso" produz como resultado (retorno) o ',Object(i.b)("em",{parentName:"p"},"token")," de acesso. Tal ",Object(i.b)("em",{parentName:"p"},"token")," \xe9 exigido por todos os demais servi\xe7os. Ou seja, primeiro se obt\xe9m o ",Object(i.b)("em",{parentName:"p"},"token"),' de acesso, que tem validade por 30 minutos, e depois ele \xe9 reutilizado, neste per\xedodo, em todas as demais requisi\xe7\xf5es. Transcorridos os 30 minutos, ser\xe1 necess\xe1rio uma nova requisi\xe7\xe3o ao servi\xe7o "Obter token de acesso", para que um novo ',Object(i.b)("em",{parentName:"p"},"token"),", v\xe1lido pelos pr\xf3ximos 30 minutos, possa ser reutilizado."),Object(i.b)("p",null,"A indica\xe7\xe3o do certificado digital a ser utilizado pelo Postman \xe9 realizada da seguinte forma. Selecione ",Object(i.b)("em",{parentName:"p"},"File")," (op\xe7\xe3o do ",Object(i.b)("em",{parentName:"p"},"menu"),"), na sequ\xeancia a op\xe7\xe3o ",Object(i.b)("em",{parentName:"p"},"Settings")," e, por fim, abre-se a janela abaixo, na qual a aba ",Object(i.b)("em",{parentName:"p"},"Certificates")," deve ser selecionada e, por \xfaltimo, ",Object(i.b)("em",{parentName:"p"},"Add Certificate"),"."),Object(i.b)("p",null,Object(i.b)("img",{alt:"img",src:o(306).default})),Object(i.b)("p",null,"Quando ",Object(i.b)("em",{parentName:"p"},"Add Certificate")," \xe9 pressionado, abre-se tela similar \xe0quela abaixo.\nObserve que nenhum valor estar\xe1 preenchido, ao contr\xe1rio da tela exibida abaixo, na qual as tr\xeas informa\xe7\xf5es exigidas j\xe1 est\xe3o fornecidas: (a) o dom\xednio para o qual o certificado ser\xe1 utilizado pelo Postman, ou seja, a porta ",Object(i.b)("em",{parentName:"p"},"Auth")," do ",Object(i.b)("a",{parentName:"p",href:"../../rnds/ambientes"},"ambiente")," de homologa\xe7\xe3o ou, especificamente, o endere\xe7o ",Object(i.b)("strong",{parentName:"p"},"ehr-auth-hmg.saude.gov.br"),"; (b) o arquivo ",Object(i.b)("strong",{parentName:"p"},".pfx")," contendo o certificado digital do estabelecimento de sa\xfade e, por \xfaltimo, (c) a senha empregada para se ter acesso ao conte\xfado do certificado."),Object(i.b)("p",null,Object(i.b)("img",{alt:"img",src:o(168).default})),Object(i.b)("p",null,"Ao clicar no bot\xe3o ",Object(i.b)("inlineCode",{parentName:"p"},"Add"),", o Postman estar\xe1 configurado para usar o certificado, para acesso ao endere\xe7o indicado e, para o uso, empregar\xe1 a senha fornecida."),Object(i.b)("p",null,'Ap\xf3s a configura\xe7\xe3o do certificado, quando se requisita a submiss\xe3o do servi\xe7o "Obter token de acesso", que est\xe1 dispon\xedvel exatamente\nno endere\xe7o fornecido na configura\xe7\xe3o acima, o certificado e a senha ser\xe3o utilizados pelo Postman para submter a requisi\xe7\xe3o em quest\xe3o. Agora, o resultado esperado \xe9 200 OK. Observe que, logo abaixo, uma visualiza\xe7\xe3o (',Object(i.b)("em",{parentName:"p"},"visualize"),") alternativa do retorno oferecido pela RNDS \xe9 exibida, na qual o ",Object(i.b)("em",{parentName:"p"},"access_token")," \xe9 ocultado. As demais informa\xe7\xf5es n\xe3o s\xe3o sigilosas. Em particular, observe que o ",Object(i.b)("em",{parentName:"p"},"token")," tem uma validade de 30 minutos, ou seja, a inten\xe7\xe3o \xe9 que seja reutilizado neste per\xedodo, conforme mencionado anteriormente."),Object(i.b)("p",null,Object(i.b)("img",{alt:"img",src:o(307).default})),Object(i.b)("p",null,"As demais requisi\xe7\xf5es dependem de outras configura\xe7\xf5es. Mais um passo e todas elas estar\xe3o funcionando."),Object(i.b)("h3",{id:"configurar-vari\xe1veis"},"Configurar vari\xe1veis"),Object(i.b)("p",null,'A configura\xe7\xe3o do Postman para fazer uso do certifica digital viabiliza a execu\xe7\xe3o da requisi\xe7\xe3o "Obter token de acesso". As demais, contudo, al\xe9m do\n',Object(i.b)("em",{parentName:"p"},"token")," retornado por esta requisi\xe7\xe3o, dependem de outros valores, neste caso, depositados em vari\xe1veis. Abaixo segue o conjunto das vari\xe1veis empregadas pelo Postman para execu\xe7\xe3o das requisi\xe7\xf5es."),Object(i.b)("p",null,Object(i.b)("img",{alt:"image",src:o(308).default})),Object(i.b)("p",null,"Ao todo s\xe3o 10 vari\xe1veis, nem todas podem ser vistas acima. Os valores para as 3 primeiras, ",Object(i.b)("strong",{parentName:"p"},"individuo-cns"),", ",Object(i.b)("strong",{parentName:"p"},"lab-cnes")," e ",Object(i.b)("strong",{parentName:"p"},"lab-identificador"),", devem ser definidos de forma compat\xedvel com o certificado digital utilizado. S\xe3o valores espec\xedficos por estabelecimento de sa\xfade. Na figura acima s\xe3o fornecidos valores esp\xfarios, fict\xedcios (a serem substitu\xeddos). Por exemplo, ",Object(i.b)("strong",{parentName:"p"},"lab-cnes")," deve ter como valor o CNES do estabelecimento de sa\xfade cujo certificado digital foi fornecido ao Postman no passo anterior. Assim como ",Object(i.b)("strong",{parentName:"p"},"individuo-cns")," deve ser o CNS de um profissional de sa\xfade lotado no estabelecimento de sa\xfade em quest\xe3o."),Object(i.b)("p",null,"As 3 vari\xe1veis seguintes, ",Object(i.b)("strong",{parentName:"p"},"auth"),", ",Object(i.b)("strong",{parentName:"p"},"ehr")," e ",Object(i.b)("strong",{parentName:"p"},"ufg-cnpj"),", s\xe3o independentes do estabelecimento de sa\xfade. As duas primeiras identificam valores pertinentes ao ",Object(i.b)("a",{parentName:"p",href:"../../rnds/ambientes"},"ambiente")," de homologa\xe7\xe3o da RNDS. A \xfaltima apenas configura um CNPJ para facilitar a execu\xe7\xe3o de requisi\xe7\xe3o de consulta por CNPJ. Neste caso, este CNPJ est\xe1 dison\xedvel no pr\xf3prio portal da ",Object(i.b)("a",{parentName:"p",href:"https://ufg.br"},"UFG")," (CNPJ utilizado no exemplo)."),Object(i.b)("p",null,"Os valores das 4 \xfaltimas vari\xe1veis s\xe3o gerados pelo pr\xf3prio Postman durante a execu\xe7\xe3o das requisi\xe7\xf5es. Por exemplo, a vari\xe1vel ",Object(i.b)("em",{parentName:"p"},"access_token"),' \xe9 definida pela execu\xe7\xe3o do servi\xe7o "Obter token de acesso" e, como anteriormente informado, o valor desta vari\xe1vel \xe9 empregado na composi\xe7\xe3o do ',Object(i.b)("em",{parentName:"p"},"header")," de nome ",Object(i.b)("em",{parentName:"p"},"X-Authorization-Server")," por todas as demais requisi\xe7\xf5es."),Object(i.b)("p",null,"Vari\xe1veis espec\xedficas por estabelecimento de sa\xfade (assim como o certificado digital):"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"lab-identificador"),": identificador do laborat\xf3rio fornecido pela RNDS quando o credenciamento \xe9 homologado. Observe que este identificador n\xe3o \xe9 o CNES. Observe que o respons\xe1vel pelo laborat\xf3rio dever\xe1 acompanhar o pedido de credenciamento e, quando este \xe9 homologado, este identificador estar\xe1 dispon\xedvel por meio do portal de servi\xe7os (o mesmo empregado para pedir o credenciamento). Veja ",Object(i.b)("a",{parentName:"p",href:"../gestor/identificador"},"identificador do solicitante")," para detalhes.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"lab-cnes"),": o c\xf3digo CNES do laborat\xf3rio cujo credenciamento foi solicitado por meio do portal de servi\xe7os da RNDS e tamb\xe9m aprovado. Naturalmente, o\ncertificado digital empregado para configurar o Postaman deve ser do laborat\xf3rio em quest\xe3o.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"individuo-cns"),": conforme o pr\xf3prio nome\nindica, \xe9 o CNS de um indiv\xedduo, em particular, o CNS do profissional de sa\xfade em nome do qual requisi\xe7\xf5es ser\xe3o feitas. Ou seja, este CNS deve estar associado ao laborat\xf3rio em quest\xe3o (CNES fornecido na vari\xe1vel acima). Este valor ser\xe1 enviado para a RNDS por meio do ",Object(i.b)("em",{parentName:"p"},"header")," de nome ",Object(i.b)("strong",{parentName:"p"},"Authorization"),' em todos os contatos com a RNDS. A exce\xe7\xe3o \xe9 o servi\xe7o "Obter token de acesso", que n\xe3o faz uso deste ',Object(i.b)("em",{parentName:"p"},"header"),". Adicionalmente a este uso, com o prop\xf3sito de evitar a defini\xe7\xe3o de outra vari\xe1vel, este valor tamb\xe9m \xe9 reutilizado para outras finalidades, por exemplo, para identificar o paciente\nde um exame."))),Object(i.b)("p",null,"Vari\xe1veis de uso amplo:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"auth"),': endere\xe7o empregado para autentica\xe7\xe3o. Este valor \xe9 empregado na requisi\xe7\xe3o "Obter token de acesso", conforme ilustrado abaixo, na montagem da URL correspondente (destaque na cor laranja).')),Object(i.b)("p",null,Object(i.b)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/1735792/92814239-45834c80-f399-11ea-80b9-db68d3e4128d.png",alt:"Vari\xe1vel auth usada em URL"})),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"ehr"),": endere\xe7o para envio das requisi\xe7\xf5es de servi\xe7os (",Object(i.b)("em",{parentName:"li"},"web services"),") de sa\xfade. Enquanto o valor da vari\xe1vel ",Object(i.b)("strong",{parentName:"li"},"auth"),' \xe9 empregado apenas para a requisi\xe7\xe3o do servi\xe7o "Obter token de acesso", o valor da vari\xe1vel ',Object(i.b)("strong",{parentName:"li"},"ehr")," \xe9 empregado em todas as demais requisi\xe7\xf5es. \xc0 semelhan\xe7a de ",Object(i.b)("strong",{parentName:"li"},"auth"),", a vari\xe1vel ",Object(i.b)("strong",{parentName:"li"},"ehr")," \xe9 empregada na montagem da URL da requisi\xe7\xe3o, conforme ilustrado abaixo (destaque na cor laranja).")),Object(i.b)("p",null,Object(i.b)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/1735792/92814560-bfb3d100-f399-11ea-8c8c-d811aa75b227.png",alt:"Vari\xe1vel ehr usada em URL"})),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"ufg-cnpj"),": CNPJ da Universidade Federal de Goi\xe1s (UFG). Empregado apenas para teste. Observe que este valor pode ser obtido do pr\xf3prio portal da ",Object(i.b)("a",{parentName:"li",href:"https://ufg.br"},"UFG"),".")),Object(i.b)("p",null,"Vari\xe1veis geradas pelo pr\xf3prio Postman:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"access_token"),': gerada a partir da resposta para a requisi\xe7\xe3o "Obter token de acesso". Se executada de forma satisfat\xf3ria, deposita nesta vari\xe1vel o ',Object(i.b)("em",{parentName:"p"},"token")," de acesso a ser consultado por todas as demais requisi\xe7\xf5es.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"exame-id-lab"),': identificador gerado de forma aleat\xf3ria para um resultado de exame laboratorial. Este valor \xe9 gerado pela requisi\xe7\xe3o "Enviar resultado de exame" e utilizado pela requisi\xe7\xe3o "Substituir resultado de exame".')),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"exame-id-rnds"),': identificador gerado pela pr\xf3pria RNDS para um resultado de exame submetido de forma satisfat\xf3ria (requisi\xe7\xe3o "Enviar resultado de exame"). Este identificador \xfanico, gerado pela RNDS, \xe9 depositado nesta vari\xe1vel e, \xe0 semelhan\xe7a de ',Object(i.b)("strong",{parentName:"p"},"exame-id-lab"),', tamb\xe9m \xe9 empregado pela requisi\xe7\xe3o "Substituir resultado de exame".'))),Object(i.b)("h3",{id:"experimentar-requisi\xe7\xf5es"},"Experimentar requisi\xe7\xf5es"),Object(i.b)("p",null,"A execu\xe7\xe3o de requisi\xe7\xf5es \xe9 feita com a sele\xe7\xe3o da requisi\xe7\xe3o a ser executada e, em seguida, ao clicar no bot\xe3o ",Object(i.b)("inlineCode",{parentName:"p"},"Send"),". A requisi\xe7\xe3o ser\xe1 submetida e o retorno ser\xe1 exibido. A sugest\xe3o \xe9 experimentar mudan\xe7as nos par\xe2metros das requisi\xe7\xf5es, no ",Object(i.b)("em",{parentName:"p"},"payload")," de um resultado de exame, remover um ",Object(i.b)("em",{parentName:"p"},"header"),", alterar o valor de um ",Object(i.b)("em",{parentName:"p"},"header")," e observar os resultados. Desta forma ser\xe1 poss\xedvel adquirir flu\xeancia na intera\xe7\xe3o com a RNDS."),Object(i.b)("h3",{id:"como-criar-c\xf3digo-correspondente-\xe0s-requisi\xe7\xf5es"},"Como criar c\xf3digo correspondente \xe0s requisi\xe7\xf5es?"),Object(i.b)("p",null,"O Postman novamente ajuda aqui. Para cada requisi\xe7\xe3o o Postman apresenta como a mesma pode ser implementada usando v\xe1rias estrat\xe9gias, incluindo ferramentas de linha de comandos como ",Object(i.b)("strong",{parentName:"p"},"curl")," e ",Object(i.b)("strong",{parentName:"p"},"wget"),", por exemplo, al\xe9m de c\xf3digo em Java, C#, JavaScript, Swift e outras, perfazendo dezenas de alternativas."),Object(i.b)("p",null,"Apenas por curiosidade (e por divers\xe3o) segue como executar uma das requisi\xe7\xf5es oferecidas pela RNDS em Ocaml:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-ocaml"},'open Lwt\nopen Cohttp\nopen Cohttp_lwt_unix\n\nlet reqBody =\n  let uri = Uri.of_string "https://ehr-services.hmg.saude.gov.br/api/fhir/r4/Organization/01567601000143" in\n  let headers = Header.init ()\n    |> fun h -> Header.add h "Content-Type" "application/json"\n    |> fun h -> Header.add h "X-Authorization-Server" "Bearer tokenAqui"\n    |> fun h -> Header.add h "Authorization" "00112233445566"\n  in\n  Client.call ~headers `GET uri >>= fun (_resp, body) ->\n  body |> Cohttp_lwt.Body.to_string >|= fun body -> body\n\nlet () =\n  let respBody = Lwt_main.run reqBody in\n  print_endline (respBody)\n')),Object(i.b)("p",null,"A exce\xe7\xe3o n\xe3o adequadamente contemplada pelo Postman \xe9 a obten\xe7\xe3o do token de acesso. Contudo, esta necessidade est\xe1 devidamente desenvolvida, tanto para Java quanto JavaScript, e ",Object(i.b)("a",{parentName:"p",href:"../../conector#obter-token-de-acesso"},"documentada"),"."),Object(i.b)("h3",{id:"parab\xe9ns"},"Parab\xe9ns!"),Object(i.b)("p",null,'Os "primeiros contatos" com um servidr FHIR, possivelmente do ambiente de homologa\xe7\xe3o da RNDS foram estabelecidos. Seguramente,\nap\xf3s exercitar as v\xe1rias requisi\xe7\xf5es, a ambienta\xe7\xe3o necess\xe1ria tanto com as informa\xe7\xf5es necess\xe1rias, quanto aquelas retornadas, e a estrutura da requisi\xe7\xe3o, estar\xe1 conclu\xedda.'),Object(i.b)("p",null,"O pr\xf3ximo passo \xe9 o desenvolvimento do c\xf3digo que executa as requisi\xe7\xf5es exercitadas com o prop\xf3sito de integra\xe7\xe3o\nentre o estabelecimento de sa\xfade e a RNDS. seja atribui\xe7\xe3o de cada laborat\xf3rio, e cada um possui suas especificidades, isto n\xe3o inviabiliza mais um passo na dire\xe7\xe3o de facilitar esta integra\xe7\xe3o, que \xe9 o motivo de exist\xeancia do presente guia: ilustrar o ",Object(i.b)("a",{parentName:"p",href:"../../conector"},"conector"),"(software de integra\xe7\xe3o), um componente de software implementado, que pode inspirar ou at\xe9 ser reutilizado pelo laborat\xf3rio para a sua integra\xe7\xe3o."))}p.isMDXComponent=!0},144:function(e,a,o){"use strict";o.d(a,"a",(function(){return m})),o.d(a,"b",(function(){return u}));var t=o(0),r=o.n(t);function i(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function s(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,t)}return o}function n(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?s(Object(o),!0).forEach((function(a){i(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function d(e,a){if(null==e)return{};var o,t,r=function(e,a){if(null==e)return{};var o,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)o=i[t],a.indexOf(o)>=0||(r[o]=e[o]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)o=i[t],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var c=r.a.createContext({}),p=function(e){var a=r.a.useContext(c),o=a;return e&&(o="function"==typeof e?e(a):n(n({},a),e)),o},m=function(e){var a=p(e.components);return r.a.createElement(c.Provider,{value:a},e.children)},b={inlineCode:"code",wrapper:function(e){var a=e.children;return r.a.createElement(r.a.Fragment,{},a)}},l=r.a.forwardRef((function(e,a){var o=e.components,t=e.mdxType,i=e.originalType,s=e.parentName,c=d(e,["components","mdxType","originalType","parentName"]),m=p(o),l=t,u=m["".concat(s,".").concat(l)]||m[l]||b[l]||i;return o?r.a.createElement(u,n(n({ref:a},c),{},{components:o})):r.a.createElement(u,n({ref:a},c))}));function u(e,a){var o=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var i=o.length,s=new Array(i);s[0]=l;var n={};for(var d in a)hasOwnProperty.call(a,d)&&(n[d]=a[d]);n.originalType=e,n.mdxType="string"==typeof e?e:t,s[1]=n;for(var c=2;c<i;c++)s[c]=o[c];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,o)}l.displayName="MDXCreateElement"},168:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-certificado-dfe6a3e44aff7f30110f9f66d691213a.png"},303:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-desenvolvedor-dee46eeb5c8a4b74d082807e427351b8.png"},304:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-import-d853abdb28b274037111ecb86fbec6b6.png"},305:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-carregado-5166dd1a2d16d271fca4894f78e39e09.png"},306:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-settings-eed38bbd80ab67ccc8dab96eee96c591.png"},307:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-obter-token-c2da9cac696d68c6f4e4b3abca054d77.png"},308:function(e,a,o){"use strict";o.r(a),a.default=o.p+"assets/images/postman-variaveis-3fe564ed2b511a8f95cb380523d67d2c.png"}}]);